<!DOCTYPE html>
<html lang="en">
<head>
    <title>StationMaster</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="What is deployed? When was it deployed?">
    <meta name="author" content="radify.io">

    <link href="bootstrap.min.css" rel="stylesheet">
</head>

<body role="document">
    <div class="container" role="main">
        <div class="page-header">
            <h1>StationMaster</h1>
        </div>

        <table class="table striped">
            <thead>
                <tr><th>Branch</th><th>Deployed</th></tr>
            </thead>
            <tbody id="rows">
            </tbody>
        </table>

        <p>
            <a href="devindex.csv" class="btn btn-primary btn-large"><span class="glyphicon glyphicon-download"></span> Download as CSV</a>
        </p>
    </div>

    <footer class="bs-docs-footer" role="contentinfo">
        <div class="container">
            Brought to you by <a href="http://radify.io/">radify.io</a>
        </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $.ajax({
                type: "GET",
                url: "devindex.csv",
                dataType: "text",
                success: function(data) {processData(data);}
            });
        });

        function processData(allText) {
            var allTextLines = allText.split(/\r\n|\n/);

            for (var i=1; i<allTextLines.length; i++) {
                var row = allTextLines[i];
                if (row.length < 3) {
                    continue;
                }
                var data = row.split(',');

                $('#rows').append(
                    '<tr><td><a href="' + data[0] + '">' + data[0] + '</a></td>'
                      + '<td>' + data[1] + '</td></tr>'
                );
            }
        }
    </script>
</body>
</html>
